<!DOCTYPE html>
<html>
  <head>
    <title>My Firebase App</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js"></script>
  </head>
  <body>
    <div style="display: flex; justify-content: space-between;">
      <h1 style="margin-left: 20px;">User Name</h1>
      <h2 style="margin-right: 20px;">Current Time, Date</h2>
    </div>
    <table>
      <thead>
        <tr>
          <th>Product Name</th>
          <th>Last Seen Timestamp</th>
          <th>Weight Available</th>
          <th>Power Available</th>
          <th>Deep Sleep Time</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="product-list"></tbody>
    </table>

    <script>
      // Initialize Firebase
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyD8phDzrKZZo0VCgMMd5xK9GU6W4mBjbA4",
        authDomain: "hackthon-9f2c0.firebaseapp.com",
        databaseURL: "https://hackthon-9f2c0-default-rtdb.firebaseio.com",
        projectId: "hackthon-9f2c0",
        storageBucket: "hackthon-9f2c0.appspot.com",
        messagingSenderId: "397447510068",
        appId: "1:397447510068:web:5ed4294588e6c32e5db261",
        measurementId: "G-1FLJPX0B7Z"
      };
      firebase.initializeApp(firebaseConfig);

      // Get a reference to the database
      const database = firebase.database();

      // Get a reference to the products node
      const productsRef = database.ref("products");

      // Attach a listener to the products node
      productsRef.on("value", (snapshot) => {
        // Clear the product list
        document.getElementById("product-list").innerHTML = "";

        // Loop through each product in the snapshot
        snapshot.forEach((childSnapshot) => {
          // Get the product data
          const product = childSnapshot.val();

          // Create a new row for the product
          const row = document.createElement("tr");

          // Create a cell for the product name
          const nameCell = document.createElement("td");
          nameCell.innerText = product.name;
          row.appendChild(nameCell);

          // Create a cell for the last seen timestamp
          const lastSeenCell = document.createElement("td");
          lastSeenCell.innerText = product.lastSeenTimestamp;
          row.appendChild(lastSeenCell);

          // Create a cell for the weight available
          const weightCell = document.createElement("td");
          weightCell.innerText = product.weightAvailable;
          row.appendChild(weightCell);

          // Create a cell for the power available
          const powerCell = document.createElement("td");
          powerCell.innerText = product.powerAvailable;
          row.appendChild(powerCell);

          // Create a cell for the deep sleep time
          const deepSleepCell = document.createElement("td");
          deepSleepCell.innerText = product.deepSleepTime;
          row.appendChild(deepSleepCell);

          // Create a cell for the edit button
          const editCell = document.createElement("td");
          const editButton = document.createElement("button");
          editButton.innerText = "Edit";
          editButton.addEventListener("click", () => {
            // Prompt the user for the new weight available value
            const newWeightAvailable = prompt("Enter the new weight available value:");

            // Update the weight available value in the database
            childSnapshot.ref.child("weightAvailable").set(newWeightAvailable);
          });
          editCell.appendChild(editButton);
          row.appendChild(editCell);

          // Add the row to the product list
          document.getElementById("product-list").appendChild(row);
        });
      });
    </script>
  </body>
</html>
